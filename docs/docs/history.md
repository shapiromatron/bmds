# History

## Version 22.1

* Switched to calendar year versioning. It uses a two-part CalVer versioning scheme, such as 22.1. The first number is the year. The second is the release number within that year, starting with v1. Patch versions may be created if changes are minor
* Added BMDS 3.3 (2022.10) support. Since the shared object can now be compiled in multiple environments, we no longer allow remote execution for newer version of BMDS
* Removed BMDS < 2.7 support
* Supported wheels to build for Mac, Linux, and Windows
* Added black and flake8 to enforce code style
* Increase minimum python version to 3.9
* Allow dichotomous cancer datasets to drop doses to 2 dose-groups instead of 3
* Changed multiprocessing to use `ThreadPoolExecutor` instead of `asyncio`
* Converted documentation to mkdocs instead of sphinx

Released on 2022-12-17.

## Version 0.11.0

* Used black and flake8 to enforce code style
* Support Python3.7
* Add new `DichotomousCancerDataset` which only needs 2 dose-groups
* Fix bug with ANOVA implementation being cached with dropped doses
* Save history of models executed when dropping doses
* Decision logic:
    * Made residual of interest value failure is nonviable bin by default
    * Added degrees of freedom check (failure is nonviable bin by default)
    * Modified decision logic for variance model fit rule to align with BMDS Wizard
    * Modified high BMDL default logic less restrictive to be consistent with BMDS Wizard
    * Modified implementation of ControlStdevResiduals consistent with BMDS Wizard
* Reporting:
    * Update reporting (xlsx) to include prior sessions when doses are dropped
    * Update reporting (docx) to better document sessions where doses are dropped

Released on 2018-09-14.

## Version 0.10.0

* Add Quantal linear as a default model instead of Multistage-1
* Update documentation on default model recommendation logic
* Fix special case where all BMDLs are 0 for model recommendations

Released on 2018-04-11.

## Version 0.9.1

* Hotfix - batch word reporter
* Used default 300 dpi for printing figures in Word reports
* Use token for authentication for remote bmds execution monkeypatch instead of login (paired with updated [bmds-server](https://bmds-server.readthedocs.io/))

Released on 2018-02-22.

## Version 0.9.0

* Add BMDS version 2.7
* Added new ``Reporter`` class for creating Microsoft Word reports, as well as a default template for creating Word files. The reports may contain:
    - a table for the input dataset (on by default)
    - a summary table of model summary results (on by default)
    - a summary table of model recommendation notes (on by default)
    - the recommended model output file and figure (on by default)
    - all executed model output files and figures (off by default)
* Increased BMDS_MODEL_TIMEOUT_SECONDS from 10 to 30 seconds
* Revised outputs figures generated by library
    - modify BMDL line to be consistent with BMDS library (align with BMR)
    - add new options to specify xlabel and ylabel
    - revise title to include dataset name and BMR
    - add legend

Released on 2017-11-07.

## Version 0.8.1

* Use ``asyncio.create_subprocess_exec`` instead of custom Thread implementation for running BMDS models
* Add new output to capture if BMDS model killed (``execution_halted``) based on Timeout; added to all output formats
* Capture ``stdout`` and ``stderr`` for models which successfully complete  (in variables appropriately named ``stdout`` and ``stderr``); added to dict and data-frame outputs
* Added new setting, ``MAXIMUM_POLYNOMIAL_ORDER``, by default equal to 8
* Added new setting, ``SUFFICIENTLY_CLOSE_BMDL``, by default equal to 3
* Delimit text messages (logic-failures, warnings) by newline instead of semicolon
* Add BMDS version and python BMDS version to session dictionary outputs
* Set exponential model direction based on dataset instead of letting model guess- this should fix failures where exponential models write "Error in closing opened file" to stdout
* Improved documentation on model recommendation logic
* Revise ``ContinuousDataset.is_increasing`` for better edge-case checks
* Capture observed fit dose and response for exponential continuous individual models; which allows calculation for a residual of interest
* Added [Appveyor](https://ci.appveyor.com/project/shapiromatron/bmds) for testing on Windows

Released on 2017-06-06.

## Version 0.8.0

* Dropped support for Python 2 and Python â‰¤ 3.4
* Added [asyncio](https://docs.python.org/3/library/asyncio.html) python 3 standard library used for performance gains
* Fix memory leak by closing matplotlib figures
* Added new optional ``dpi`` argument to ``Session.save_plots()``
* Allow ``**kwargs`` arguments in datasets; these are returned in ``to_dict()``

Released on 2017-04-28.

## Version 0.7.0

* Recommend the most parsimonious model, instead of the first model with target AIC/BMDL
* Add new method to the session, ``execute_and_recommend``, with the option to try dropping doses until a model recommendation exists, or the dataset is exhausted
* Add runtime details to output
* Hide model failure popup when bmds unexpectedly fails  (significant performance boost)
* Log failures by default, including displaying failed input (d) files

Released on 2017-03-17.

## Version 0.6.0

* Added new ``drop_dose`` method to Dataset
* Do not attempt to execute model when there are too few dose-groups
* Remove doses-dropped parameter from dataset init
* Add example notebook running actual data

Released on 2017-03-10.

## Version 0.5.3

* Prevent errors when software is run with un-runnable dose-response datasets
* Handle edge-cases for ANOVA calculation failure
* Fix 002 bmds temporary file cleanup

Released on 2017-03-02.

## Version 0.5.2

* Add custom exceptions for BMDS package
* Explicitly check that BMDS remote-server authentication is successful
* Hotfix - fix error when running continuous models with 3 dose groups

Released on 2017-02-15.

## Version 0.5.1

* hotfix - fix exponential models (they create additional temporary files, had to ensure that they're collected and removed.)

Released on 2016-12-23.

## Version 0.5.0

* For multistage and multistage cancer, by default an order 1 polynomial model is also executed (previously started at order 2)
* Update documentation beyond quickstart including API
* Export results as a pandas DataFrame, CSV, or Excel, in addition to JSON, and python dictionaries
* Generate dose-response plots using matplotlib
* Export dose-response plots
* Improve documentation with better describing API and quickstart

Released on 2016-12-23.

## Version 0.4.0

* Added Dichotomous-Hill model to list of dichotomous models
* Allowed global overrides (such as BMR settings) as an optional input to ``Session.add_default_models``
* Updated test-logic outputs for individual tests (and added tests)
* For continuous summary datasets, rename ``responses`` array to ``means``
* By default, polynomial-like models are run multiple times with different degrees.
    - Previously, a single polynomial model was added with an order of ``min(n-1, 8)``, where ``n`` is the number of dose-groups. Now, multilpe models are added ranging from ``[3 - min(n-1, 8)]``, inclusive
    - Polynomial like models include: Polynomial, Multistage, and Multistage-Cancer
* Added the ability to use individual continuous data, instead of summary data

Released on 2016-12-14.

## Version 0.3.0

* Model recommendation system enabled [Wignall et al. 2014](https://doi.org/10.1289/ehp.1307539)
* Default continuous variance model now calculated based on dataset using same statistics as BMDS [Thanks Longlong!]
* Default polynomial restriction based on if dataset is increasing or decreasing (previously unrestricted)
* Add new batch dFileRunner to execute multiple dfiles in batch-mode (integration w/ bmds-server)
* Updated Makefile to include with a new tmux developer environment

Released on 2016-12-05.

## Version 0.2.0

* Remove older version of BMDS unused in model code
* Updated to working versions of BMDS code

Released on 2016-11-23.

## Version 0.1.0

* Allowed for monkeypatch check for executing on linux, since BMDS is Windows-only
* Added model recommendation logic
* Added python 3 support (3.5)
* First PyPI release

Released on 2016-10-25.

## Version 0.0.1

* Initial version

Released on 2016-07-29.
